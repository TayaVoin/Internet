# Управляем данными

CRUD (Create, Read, Update, Delete) — это "хлеб с маслом" любого бэкенд-разработчика. 90% веб-сервисов занимаются именно этим. Но просто перекладывать JSON из запроса в базу — мало. Хороший сервис должен быть надежным: не падать от плохих данных и говорить клиенту, что именно пошло не так.

## Ключевые понятия
- **Валидация** — первая линия обороны. Не пускайте "мусор" в свою бизнес-логику. Pydantic в FastAPI делает это за вас.
- **Обработка ошибок** — клиент не должен видеть стектрейсы Python. Он должен видеть: `{"detail": "Item not found"}`.
- **Коды ответов**:
  - `400 Bad Request` — клиент ошибся в логике запроса.
  - `404 Not Found` — запрашиваемого ресурса не существует.
  - `422 Unprocessable Entity` — ошибка валидации полей (стандарт для FastAPI).
  - `500 Internal Server Error` — ошибка на стороне сервера (мы сломались, простите).

## PUT vs PATCH
- **PUT** заменяет ресурс целиком. Если вы не передали какое-то поле, оно должно быть затерто или сброшено в значение по умолчанию.
- **PATCH** меняет только те поля, которые были переданы в запросе.
На этой неделе мы реализуем **PUT**, так как он проще для понимания идемпотентности.

## Пример из жизни
Вы заполняете форму регистрации, ошиблись в номере телефона. Если сервис просто упадет с 500 ошибкой — вы уйдете с сайта. Если подсветит поле красным и напишет "Неверный формат" (422) — вы исправите ошибку. Качественный API помогает пользователю (или фронтенду) исправить свои ошибки.

## Что почитать
- [Pydantic: модели](https://docs.pydantic.dev/latest/) — как описывать схемы данных.
- [FastAPI: Обработка ошибок](https://fastapi.tiangolo.com/tutorial/handling-errors/) — как возвращать HTTPExceptions.
